<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="colaborador">

    <!-- ============================= -->
    <!-- INSERTAR                      -->
    <!-- ============================= -->
    <insert id="insertar-colaborador" parameterType="pojo.Colaborador">
        INSERT INTO Colaborador( 
        noPersonal, nombre, apellidoPaterno, apellidoMaterno,  
        curp, correo, telefono, foto, password, numeroLicencia, 
        idRol, idSucursal
        ) 
        VALUES ( 
        #{noPersonal}, #{nombre}, #{apellidoPaterno}, #{apellidoMaterno}, 
        #{curp}, #{correo}, #{telefono}, #{foto}, #{password}, 
        #{numeroLicencia}, #{idRol}, #{idSucursal}
        )
    </insert>

    <!-- ============================= -->
    <!-- ACTUALIZAR                    -->
    <!-- ============================= -->
    <update id="actualizar-colaborador" parameterType="pojo.Colaborador">
        UPDATE Colaborador 
        SET 
        nombre = #{nombre}, 
        apellidoPaterno = #{apellidoPaterno}, 
        apellidoMaterno = #{apellidoMaterno}, 
        curp = #{curp}, 
        telefono = #{telefono}, 
        foto = #{foto},  
        password = #{password},  
        numeroLicencia = #{numeroLicencia}, 
        idSucursal = #{idSucursal} 
        WHERE idColaborador = #{idColaborador}
    </update>

    <!-- ============================= -->
    <!-- ELIMINAR                      -->
    <!-- ============================= -->
    <delete id="eliminar-colaborador" parameterType="int">
        DELETE FROM Colaborador 
        WHERE idColaborador = #{idColaborador}
    </delete>

    <!-- ============================= -->
    <!-- BUSCAR POR NOMBRE             -->
    <!-- ============================= -->
    <select id="buscar-por-nombre" parameterType="string" resultType="pojo.Colaborador">
        SELECT * 
        FROM Colaborador 
        WHERE nombre LIKE CONCAT('%', #{_parameter}, '%') 
    </select>

    <!-- ============================= -->
    <!-- BUSCAR POR NO PERSONAL        -->
    <!-- ============================= -->
    <select id="buscar-por-noPersonal" parameterType="string" resultType="pojo.Colaborador">
        SELECT * 
        FROM Colaborador 
        WHERE noPersonal = #{noPersonal}
    </select>

    <!-- ============================= -->
    <!-- BUSCAR POR ROL                -->
    <!-- ============================= -->
    <select id="buscar-por-rol" parameterType="int" resultType="pojo.Colaborador">
        SELECT * 
        FROM Colaborador 
        WHERE idRol = #{idRol}
    </select>

    <!-- ============================= -->
    <!-- ACTUALIZAR PERFIL (MÃ³vil)     -->
    <!-- ============================= -->
    <update id="actualizar-perfil" parameterType="pojo.Colaborador">
        UPDATE Colaborador 
        SET 
        nombre = #{nombre}, 
        apellidoPaterno = #{apellidoPaterno}, 
        apellidoMaterno = #{apellidoMaterno}, 
        telefono = #{telefono}, 
        foto = #{foto}, 
        password = #{password} 
        WHERE idColaborador = #{idColaborador} 
    </update>

    <!-- ============================= -->
    <!-- LOGIN                         -->
    <!-- ============================= -->
    <select id="login-colaborador" parameterType="map" resultType="pojo.Colaborador">
        SELECT c.idColaborador, c.noPersonal, c.nombre, c.apellidoPaterno, c.apellidoMaterno, 
        c.curp, c.correo, c.telefono, c.foto, c.numeroLicencia, c.idRol,
        r.nombre AS nombreRol, 
        c.idSucursal 
        FROM Colaborador c 
        INNER JOIN Rol r ON c.idRol = r.idRol 
        WHERE c.noPersonal = #{noPersonal} 
        AND c.password = #{password} 
    </select>

</mapper>
